# Use a multi-stage build
FROM maven:3.9.6-eclipse-temurin-17 AS builder

# Set working directory
WORKDIR /build

# Copy settings.xml first
COPY settings.xml /root/.m2/settings.xml

# Copy the project files
COPY . .

# Change RUN to CMD and skip Javadoc
CMD ["mvn", "clean", "deploy", "-P", "release", "-Dmaven.javadoc.skip=true", "-Dmaven.test.skip=true", "-f", "sdk/trade360-java-sdk/pom.xml", "--batch-mode", "--no-transfer-progress"]